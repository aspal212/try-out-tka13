<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Peserta - Try Out TKA13</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="../index.html">
                <i class="bi bi-mortarboard-fill"></i>
                Try Out TKA13 - Admin
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="dashboard.html">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="questions.html">Manajemen Soal</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="participants.html">Peserta</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="results.html">Hasil Ujian</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="exam-management.html">Kelola Ujian</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-person-circle"></i> Admin
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="settings.html">Pengaturan</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" onclick="logout()">Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid mt-4">
        <!-- Page Header -->
        <div class="row mb-4">
            <div class="col">
                <h2><i class="bi bi-people"></i> Manajemen Peserta</h2>
                <p class="text-muted">Kelola data peserta ujian dengan mudah</p>
            </div>
            <div class="col-auto">
                <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#bulkImportModal">
                    <i class="bi bi-upload"></i> Import Peserta
                </button>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addParticipantModal">
                    <i class="bi bi-person-plus"></i> Tambah Peserta
                </button>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card bg-primary text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5>Total Peserta</h5>
                                <h3>1,234</h3>
                            </div>
                            <i class="bi bi-people" style="font-size: 2rem;"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-success text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5>Aktif</h5>
                                <h3>1,100</h3>
                            </div>
                            <i class="bi bi-check-circle" style="font-size: 2rem;"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-warning text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5>Menunggu</h5>
                                <h3>89</h3>
                            </div>
                            <i class="bi bi-clock" style="font-size: 2rem;"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-danger text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5>Terblokir</h5>
                                <h3>45</h3>
                            </div>
                            <i class="bi bi-x-circle" style="font-size: 2rem;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Participant Modal -->
<div class="modal fade" id="addParticipantModal" tabindex="-1" aria-labelledby="addParticipantModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="addParticipantModalLabel">
                    <i class="bi bi-person-plus"></i> Tambah Peserta Baru
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="participantForm" novalidate>
                    <div class="row">
                        <!-- Data Pribadi -->
                        <div class="col-lg-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-person"></i> Data Pribadi</h6>
                                </div>
                                <div class="card-body">
                                    <!-- Nama Lengkap -->
                                    <div class="mb-3">
                                        <label for="fullName" class="form-label">Nama Lengkap <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="fullName" name="fullName" required>
                                        <div class="invalid-feedback">Nama lengkap harus diisi</div>
                                    </div>

                                    <!-- Email -->
                                    <div class="mb-3">
                                        <label for="email" class="form-label">Email <span class="text-danger">*</span></label>
                                        <input type="email" class="form-control" id="email" name="email" required>
                                        <div class="invalid-feedback">Format email tidak valid</div>
                                        <div class="form-text">Email harus unik untuk setiap peserta</div>
                                    </div>

                                    <!-- NIS -->
                                    <div class="mb-3">
                                        <label for="nis" class="form-label">NIS/NIP</label>
                                        <input type="text" class="form-control" id="nis" name="nis" placeholder="Nomor Induk Siswa">
                                    </div>

                                    <!-- Nomor Telepon -->
                                    <div class="mb-3">
                                        <label for="phone" class="form-label">Nomor Telepon</label>
                                        <input type="tel" class="form-control" id="phone" name="phone" placeholder="08xxxxxxxxxx">
                                        <div class="form-text">Contoh: 081234567890</div>
                                    </div>

                                    <!-- Jenis Kelamin -->
                                    <div class="mb-3">
                                        <label class="form-label">Jenis Kelamin <span class="text-danger">*</span></label>
                                        <div class="d-flex gap-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="gender" id="male" value="L" required>
                                                <label class="form-check-label" for="male">
                                                    <i class="bi bi-gender-male text-primary"></i> Laki-laki
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="gender" id="female" value="P" required>
                                                <label class="form-check-label" for="female">
                                                    <i class="bi bi-gender-female text-danger"></i> Perempuan
                                                </label>
                                            </div>
                                        </div>
                                        <div class="invalid-feedback">Pilih jenis kelamin</div>
                                    </div>

                                    <!-- Tanggal Lahir -->
                                    <div class="mb-3">
                                        <label for="birthDate" class="form-label">Tanggal Lahir</label>
                                        <input type="date" class="form-control" id="birthDate" name="birthDate">
                                    </div>

                                    <!-- Alamat -->
                                    <div class="mb-3">
                                        <label for="address" class="form-label">Alamat</label>
                                        <textarea class="form-control" id="address" name="address" rows="3" placeholder="Alamat lengkap"></textarea>
                                    </div>

                                    <!-- Agama -->
                                    <div class="mb-3">
                                        <label for="religion" class="form-label">Agama</label>
                                        <select class="form-select" id="religion" name="religion">
                                            <option value="">Pilih Agama</option>
                                            <option value="Islam">Islam</option>
                                            <option value="Kristen">Kristen</option>
                                            <option value="Katolik">Katolik</option>
                                            <option value="Hindu">Hindu</option>
                                            <option value="Buddha">Buddha</option>
                                            <option value="Konghucu">Konghucu</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Data Pendidikan & Keluarga -->
                        <div class="col-lg-6">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-building"></i> Data Pendidikan</h6>
                                </div>
                                <div class="card-body">
                                    <!-- Sekolah/Institusi -->
                                    <div class="mb-3">
                                        <label for="school" class="form-label">Sekolah/Institusi <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="school" name="school" required placeholder="Nama sekolah/institusi">
                                        <div class="invalid-feedback">Nama sekolah harus diisi</div>
                                    </div>

                                    <!-- Kelas -->
                                    <div class="mb-3">
                                        <label for="class" class="form-label">Kelas <span class="text-danger">*</span></label>
                                        <select class="form-select" id="class" name="class" required>
                                            <option value="">Pilih Kelas</option>
                                            <option value="7">Kelas 7</option>
                                            <option value="8">Kelas 8</option>
                                            <option value="9">Kelas 9</option>
                                            <option value="10">Kelas 10</option>
                                            <option value="11">Kelas 11</option>
                                            <option value="12">Kelas 12</option>
                                        </select>
                                        <div class="invalid-feedback">Pilih kelas</div>
                                    </div>

                                    <!-- Jurusan -->
                                    <div class="mb-3">
                                        <label for="major" class="form-label">Jurusan</label>
                                        <select class="form-select" id="major" name="major">
                                            <option value="">Pilih Jurusan</option>
                                            <option value="IPA">IPA</option>
                                            <option value="IPS">IPS</option>
                                            <option value="Bahasa">Bahasa</option>
                                            <option value="IPC">IPC</option>
                                            <option value="Lainnya">Lainnya</option>
                                        </select>
                                    </div>

                                    <!-- Tahun Ajaran -->
                                    <div class="mb-3">
                                        <label for="academicYear" class="form-label">Tahun Ajaran <span class="text-danger">*</span></label>
                                        <select class="form-select" id="academicYear" name="academicYear" required>
                                            <option value="">Pilih Tahun Ajaran</option>
                                            <option value="2024/2025">2024/2025</option>
                                            <option value="2025/2026">2025/2026</option>
                                        </select>
                                        <div class="invalid-feedback">Pilih tahun ajaran</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Data Orang Tua -->
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-people"></i> Data Orang Tua/Wali</h6>
                                </div>
                                <div class="card-body">
                                    <!-- Nama Orang Tua -->
                                    <div class="mb-3">
                                        <label for="parentName" class="form-label">Nama Orang Tua/Wali</label>
                                        <input type="text" class="form-control" id="parentName" name="parentName" placeholder="Nama ayah/ibu/wali">
                                    </div>

                                    <!-- Hubungan -->
                                    <div class="mb-3">
                                        <label for="parentRelation" class="form-label">Hubungan</label>
                                        <select class="form-select" id="parentRelation" name="parentRelation">
                                            <option value="">Pilih Hubungan</option>
                                            <option value="Ayah">Ayah</option>
                                            <option value="Ibu">Ibu</option>
                                            <option value="Wali">Wali</option>
                                        </select>
                                    </div>

                                    <!-- Nomor Telepon Orang Tua -->
                                    <div class="mb-3">
                                        <label for="parentPhone" class="form-label">Nomor Telepon Orang Tua</label>
                                        <input type="tel" class="form-control" id="parentPhone" name="parentPhone" placeholder="08xxxxxxxxxx">
                                    </div>

                                    <!-- Email Orang Tua -->
                                    <div class="mb-3">
                                        <label for="parentEmail" class="form-label">Email Orang Tua</label>
                                        <input type="email" class="form-control" id="parentEmail" name="parentEmail" placeholder="email@orangtua.com">
                                    </div>

                                    <!-- Pekerjaan Orang Tua -->
                                    <div class="mb-3">
                                        <label for="parentJob" class="form-label">Pekerjaan</label>
                                        <input type="text" class="form-control" id="parentJob" name="parentJob" placeholder="Pekerjaan orang tua">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pengaturan Akun -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-shield-lock"></i> Pengaturan Akun</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <!-- Generate Akun Otomatis -->
                                        <div class="col-lg-6">
                                            <div class="mb-3">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input" type="checkbox" id="autoGenerate" checked>
                                                    <label class="form-check-label" for="autoGenerate">
                                                        <strong>Generate akun otomatis</strong>
                                                    </label>
                                                </div>
                                                <div class="form-text">Sistem akan membuat username dan password secara otomatis</div>
                                            </div>

                                            <div id="autoGenerateFields" class="mt-3">
                                                <div class="row">
                                                    <div class="col-6">
                                                        <label for="username" class="form-label">Username</label>
                                                        <input type="text" class="form-control" id="username" name="username" readonly>
                                                    </div>
                                                    <div class="col-6">
                                                        <label for="password" class="form-label">Password</label>
                                                        <div class="input-group">
                                                            <input type="text" class="form-control" id="password" name="password" readonly>
                                                            <button class="btn btn-outline-secondary" type="button" id="regenerateBtn">
                                                                <i class="bi bi-arrow-clockwise"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-text mt-2" id="credentialsInfo">
                                                    Akun akan digenerate berdasarkan nama dan email
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Manual Input -->
                                        <div class="col-lg-6">
                                            <div id="manualFields" style="display: none;">
                                                <div class="mb-3">
                                                    <label for="manualUsername" class="form-label">Username</label>
                                                    <input type="text" class="form-control" id="manualUsername" name="manualUsername" placeholder="Masukkan username">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="manualPassword" class="form-label">Password</label>
                                                    <input type="password" class="form-control" id="manualPassword" name="manualPassword" placeholder="Masukkan password">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <hr>

                                    <div class="row">
                                        <!-- Status Akun -->
                                        <div class="col-lg-4">
                                            <div class="mb-3">
                                                <label for="accountStatus" class="form-label">Status Akun <span class="text-danger">*</span></label>
                                                <select class="form-select" id="accountStatus" name="accountStatus" required>
                                                    <option value="aktif">Aktif - Bisa mengikuti ujian</option>
                                                    <option value="menunggu">Menunggu Verifikasi</option>
                                                    <option value="terblokir">Terblokir - Tidak bisa login</option>
                                                </select>
                                                <div class="invalid-feedback">Pilih status akun</div>
                                            </div>
                                        </div>

                                        <!-- Kelompok Ujian -->
                                        <div class="col-lg-4">
                                            <div class="mb-3">
                                                <label for="examGroup" class="form-label">Kelompok Ujian</label>
                                                <select class="form-select" id="examGroup" name="examGroup">
                                                    <option value="umum">Umum</option>
                                                    <option value="regular">Regular</option>
                                                    <option value="premium">Premium</option>
                                                    <option value="private">Private</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Prioritas -->
                                        <div class="col-lg-4">
                                            <div class="mb-3">
                                                <label for="priority" class="form-label">Prioritas</label>
                                                <select class="form-select" id="priority" name="priority">
                                                    <option value="normal">Normal</option>
                                                    <option value="prioritas">Prioritas</option>
                                                    <option value="khusus">Khusus</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <!-- Izinkan Ujian Perbaikan -->
                                        <div class="col-lg-6">
                                            <div class="form-check form-switch mb-3">
                                                <input class="form-check-input" type="checkbox" id="allowRetake" name="allowRetake" checked>
                                                <label class="form-check-label" for="allowRetake">
                                                    Izinkan ujian perbaikan
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Izinkan Download Sertifikat -->
                                        <div class="col-lg-6">
                                            <div class="form-check form-switch mb-3">
                                                <input class="form-check-input" type="checkbox" id="allowDownload" name="allowDownload" checked>
                                                <label class="form-check-label" for="allowDownload">
                                                    Izinkan download sertifikat
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Catatan -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-sticky"></i> Catatan Tambahan</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="medicalCondition" class="form-label">Kondisi Kesehatan Khusus</label>
                                        <textarea class="form-control" id="medicalCondition" name="medicalCondition" rows="2" placeholder="Contoh: Buta warna, ADHD, dll (kosongkan jika tidak ada)"></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="notes" class="form-label">Catatan</label>
                                        <textarea class="form-control" id="notes" name="notes" rows="3" placeholder="Catatan tambahan tentang peserta"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle"></i> Batal
                </button>
                <button type="button" class="btn btn-outline-primary" onclick="resetParticipantForm()">
                    <i class="bi bi-arrow-clockwise"></i> Reset Form
                </button>
                <button type="button" class="btn btn-success" onclick="saveAndAddAnother()">
                    <i class="bi bi-save2"></i> Simpan & Tambah Lagi
                </button>
                <button type="button" class="btn btn-primary" onclick="saveParticipant()">
                    <i class="bi bi-save"></i> Simpan Peserta
                </button>
            </div>
        </div>
    </div>
</div>
        <!-- Filters and Search -->
        <div class="row mb-4">
            <div class="col-md-4">
                <input type="text" class="form-control" placeholder="Cari nama, email, atau ID..." id="searchParticipant">
            </div>
            <div class="col-md-3">
                <select class="form-select" id="filterStatus">
                    <option value="">Semua Status</option>
                    <option value="aktif">Aktif</option>
                    <option value="menunggu">Menunggu Verifikasi</option>
                    <option value="terblokir">Terblokir</option>
                </select>
            </div>
            <div class="col-md-3">
                <select class="form-select" id="filterExam">
                    <option value="">Semua Ujian</option>
                    <option value="tka13-2025">TKA13 2025</option>
                    <option value="simulasi-1">Simulasi 1</option>
                    <option value="simulasi-2">Simulasi 2</option>
                </select>
            </div>
            <div class="col-md-2">